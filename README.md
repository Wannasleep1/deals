# Описание проекта

Проект построен на фреймворках Django и Django Rest Framework.
К проекту покдлючена простая встроенная в DRF документация API.

В качестве СУБД выбрана PostgreSQL. В проекте используется одна из её особенностей: агрегация строк.
Для хранения кэша используется Redis.

В качестве сервера выбран WSGI-сервер Gunicorn - он прост в установке, настройке и запуске.
Поддерживается параллелизм при обработке запросов за счёт создания worker'ов в отдельных процессах.
Также задана настройка для автоматической перезагрузки worker'а при изменениях в коде.

Сервисы проекта развернуты в контейнерах Docker. Созданы именованные тома для хранения данных.
Локальная директория app прикреплена к директории /srv/app контейнера с приложением, что позволяет
не пересоздавать контейнер при изменении в коде. Директория для хранения статичных данных вынесена
за пределы директории app, чтобы не загромождать ими локальный проект и хранить их только в
контейнере.

### Запуск

*Примечание*: необходима предварительная установка Docker и Docker Compose.

Для полноценного запуска и работы достаточно выполнить две команды:

1. Сборка проекта

```shell
sudo docker-compose build
```
2. Запуск

```shell
sudo docker-compose up
```
Также можно выполнить одну команду для сборки и последующего запуска:

```shell
sudo docker-compose up --build
```
а при дальнейших запусках уже использовать команду из п.2.

Применение миграций и сборка статики проихсодят автоматически.

### Описание API

Базовый URL API: http://127.0.0.1:8000/api/

Реализованные методы:

1. Загрузка и обработка файла в формате .csv

   Метод: POST process_deals/ (http://127.0.0.1:8000/api/process_deals/)
   
   Поля: file - файл в формате .csv
   
   Описание: отправить файл на сервер, где он будет обработан, а данные из него сохранены в БД 
   
2. Вывод списка пяти самых активных покупателей
   
   Метод: GET customer/ (http://127.0.0.1:8000/api/customer/)
   
   Описание: выводит выборку, состоящую из информации о пяти самых активных покупателях,
   которые потратили наибольшую сумму. Помимо данных о пользователе, каждый элемент выборки
   содержит информацию о итоговой отраченной сумме данным покупателем и список камней по условию.
   
### Дополнительно

- Административный сайт: http://127.0.0.1:8000/admin/
- Документация API: http://127.0.0.1:8000/docs/
- В проекте доступен Django Debug Toolbar для проверки работы проекта
